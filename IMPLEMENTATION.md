# Руководство по реализации Boost Marketplace

## Обзор системы

Маркетплейс для голосов Telegram Boost на блокчейне TON, где:
- **1 голос = 1 BOOST токен**
- Пользователи получают токены с вестингом до окончания срока голосов
- Владельцы каналов платят BOOST токенами за заявки на голоса

## Компоненты системы

### 1. Smart Contracts (TON)

#### BoostToken.fc
- Токен стандарта Jetton на TON
- Функции: mint, transfer, burn
- Владелец может минтить токены

#### Marketplace.fc
- Управление заявками на голоса
- Вестинг токенов
- Функции:
  - `create_request` - создание заявки
  - `vote_for_channel` - голосование за канал
  - `withdraw_tokens` - вывод разблокированных токенов

### 2. Telegram Bot

**Основные функции:**
- Добавление бота в канал
- Создание заявок через команду `/create`
- Просмотр активных заявок через `/list`

**Интеграция:**
- Проверка прав администратора
- Связь с Mini App для создания заявок
- Уведомления о статусе заявок

### 3. Backend API

**Endpoints:**
- `GET /api/requests` - список активных заявок
- `GET /api/requests/:id` - информация о заявке
- `POST /api/requests` - создание заявки
- `GET /api/vesting/:address` - информация о вестинге
- `POST /api/vesting/:address/withdraw` - вывод токенов
- `GET /api/price/boost` - цена BOOST в USD

**Интеграция с блокчейном:**
- Чтение данных из смарт-контрактов
- Отправка транзакций через TON SDK
- Кэширование данных для производительности

### 4. Mini App (Next.js)

**Страницы:**
- Главная - список активных заявок
- Создание заявки (для владельцев каналов)
- Профиль - информация о вестинге

**Функционал:**
- Подключение кошелька через TON Connect
- Голосование за каналы
- Отображение цены в USD
- Вывод токенов

## Поток работы

### Для владельца канала:

1. Добавляет бота в канал
2. Создает заявку через `/create` или Mini App
3. Указывает:
   - Количество нужных голосов
   - Дедлайн
   - Переводит BOOST токены (1 токен = 1 голос)
4. Заявка появляется в маркетплейсе
5. Пользователи голосуют за канал
6. После достижения цели или дедлайна заявка закрывается

### Для пользователя:

1. Открывает Mini App
2. Подключает кошелек TON
3. Просматривает активные заявки
4. Выбирает канал и количество голосов
5. Голосует за канал
6. Получает BOOST токены с вестингом
7. После разблокировки может вывести токены

## Интеграция с Telegram Boost API

Для реальной работы с голосами нужно использовать Telegram Bot API:

```typescript
// Пример вызова API для голосования
const response = await axios.post(
  `https://api.telegram.org/bot${BOT_TOKEN}/setChatBoost`,
  {
    chat_id: channelId,
    boost_count: votes
  }
);
```

**Важно:** Telegram Boost API доступен только для Premium пользователей и имеет ограничения.

## Вестинг токенов

Токены блокируются до окончания срока голосов:
- `unlock_time = deadline` (дедлайн заявки)
- До разблокировки токены нельзя вывести
- После разблокировки пользователь может вывести все токены

## Ценообразование

Цена BOOST токена определяется:
1. Через DEX (если токен листится)
2. Через оракул цен
3. Через соотношение BOOST/TON и TON/USD

В примере используется упрощенная логика: `1 BOOST = 0.01 TON`

## Безопасность

1. **Проверка прав** - только администраторы каналов могут создавать заявки
2. **Валидация данных** - проверка всех входных данных
3. **Защита от повторного голосования** - один пользователь может голосовать только один раз за заявку
4. **Проверка дедлайна** - нельзя голосовать после истечения срока

## Деплой

### 1. Смарт-контракты
```bash
cd contracts
npm run deploy
```

### 2. Backend
```bash
cd backend
npm run build
npm start
```

### 3. Mini App
```bash
cd mini-app
npm run build
# Деплой на Vercel/Netlify
```

### 4. Telegram Bot
- Создать бота через @BotFather
- Настроить Mini App URL
- Установить переменные окружения

## Дальнейшее развитие

1. **Рейтинг каналов** - на основе количества полученных голосов
2. **Реферальная программа** - бонусы за приглашение друзей
3. **NFT награды** - за активное участие
4. **DAO управление** - голосование держателей токенов
5. **Мультичейн** - поддержка других блокчейнов
